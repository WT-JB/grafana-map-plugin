{"version":3,"sources":["../src/map_renderer.js"],"names":["link","scope","elem","attrs","ctrl","mapContainer","find","events","on","render","renderingCompleted","data","map","WorldMap","resize","mapCenterMoved","panToMapCenter","hideAllByMapSize","clearCircles","setPollutants","console","log","drawPoints"],"mappings":";;;;;;AAEe,WAASA,IAAT,CAAcC,KAAd,EAAqBC,IAArB,EAA2BC,KAA3B,EAAkCC,IAAlC,EAAwC;AACrD,QAAMC,eAAeH,KAAKI,IAAL,CAAU,gBAAV,CAArB;;AAEAF,SAAKG,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB,YAAM;AAC7BC;AACAL,WAAKM,kBAAL;AACD,KAHD;;AAKA,aAASD,MAAT,GAAkB;AAChB,UAAI,CAACL,KAAKO,IAAV,EAAgB;;AAEhB,UAAI,CAACP,KAAKQ,GAAV,EAAe;AACbR,aAAKQ,GAAL,GAAW,IAAIC,QAAJ,CAAaT,IAAb,EAAmBC,aAAa,CAAb,CAAnB,CAAX;AACD;;AAEDD,WAAKQ,GAAL,CAASE,MAAT;;AAEA,UAAIV,KAAKW,cAAT,EAAyBX,KAAKQ,GAAL,CAASI,cAAT;;AAEzB;;AAEAC;;AAEAb,WAAKQ,GAAL,CAASM,YAAT;;AAEA;AACA;AACA;AACAd,WAAKQ,GAAL,CAASO,aAAT;AACA;AACA;AACAC,cAAQC,GAAR,CAAY,4BAAZ;AACAjB,WAAKQ,GAAL,CAASU,UAAT;AAED;AACF;;qBAnCuBtB,I;;;;AAFjBa,c;;AACEI,sB,mBAAAA,gB","file":"map_renderer.js","sourcesContent":["import WorldMap from './worldmap';\nimport { hideAllByMapSize } from './utils/map_utils'\nexport default function link(scope, elem, attrs, ctrl) {\n  const mapContainer = elem.find('.map-container');\n\n  ctrl.events.on('render', () => {\n    render();\n    ctrl.renderingCompleted();\n  });\n\n  function render() {\n    if (!ctrl.data) return;\n\n    if (!ctrl.map) {\n      ctrl.map = new WorldMap(ctrl, mapContainer[0]);\n    }\n\n    ctrl.map.resize();\n\n    if (ctrl.mapCenterMoved) ctrl.map.panToMapCenter();\n\n    // if (!ctrl.map.legend && ctrl.panel.showLegend) ctrl.map.createLegend();\n\n    hideAllByMapSize();\n    \n    ctrl.map.clearCircles();\n\n    //for each target drawpoints  \n    // ctrl.panel.targets.forEach((target)=>{\n    //   console.log('processing target '+target.datasource)\n    ctrl.map.setPollutants()\n    //   ctrl.map.drawPoints(target);\n    // })\n    console.log('map_render will drawPoints')\n    ctrl.map.drawPoints();\n\n  }\n}\n"]}